<html ng-app="clioBucketsApp">
  <head>
    <title> Clio Buckets </title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
    <script src="/app.js"></script>
    <style>
      table, th, td {
        border: 1px solid black;
      }
      html {
        font-family: "Comic Sans MS", "Comic Sans", cursive;
      }

    </style>
  </head>
  <body>
    <h1> The app </h1>  
    <h3 ng-controller="LogoutDirective as ctrl"> 
      <a href="#logout" ng-click="ctrl.logout()"> Logout </a>
    </h3>
    <div ng-controller="StupidController as ctrl">
      <table>
        <thead>
          <tr>
            <th> Departments </th>
            <th> Action </th>
            <th> Employees </th>
            <th> Competencies </th>
          </tr>
        </thead>
        <tbody>          
          <tr>
            <td>
              <ul>
                <li ng-repeat="department in ctrl.departments">
                  <a 
                     href="#/department/{{department.id}}" 
                     ng-click="ctrl.selectDepartment(department.id)"> 
                    {{ department.name }} 
                  </a>
                </li>
              </ul>
            </td>
            <td ng-if="ctrl.departmentId">
              <ul>
                <li>
                  <a
                     href="#/department/{{department.id}}/competencies" 
                     ng-click="ctrl.findCompetencies()"> 
                    Competencies
                  </a>
                </li>
                <li>
                  <a
                     href="#/department/{{department.id}}/users" 
                     ng-click="ctrl.findUsers()"> 
                    Users
                  </a>
                </li>
              </ul>
            </td>
            <td>
              <ul ng-if="ctrl.employees">
                <li ng-repeat="employee in ctrl.employees">
                  <a 
                     href="#/users/#{employee.id}/competencies" 
                     ng-click="ctrl.selectEmployee(employee.id)"> 
                    {{ employee.full_name }} 
                  </a>
                </li>
              </ul>
            </td>
            <td>
              <table ng-if="ctrl.userCompetencies">
                <tr>
                  <th> Rank </th>
                  <th> Competency </th>
                  <th> Category </th>
                  <th> Granted? </th>
                  <th> Actions </th>
                </tr>
                <tr ng-repeat="c in ctrl.userCompetencies">
                  <td> {{ c.rank }} </td>
                  <td> {{ c.name }} </td>
                  <td> {{ c.category }} </td>
                  <td> {{ ctrl.competenciesGranted[c.id] ? "Yes" : "No" }} </td>
                  <td> <a href> Grant </a> </td>
                </tr>
              </table>
            </td>
          </tr>
        </tbody>
      </table>      
    </div>
  </body>
</html>
